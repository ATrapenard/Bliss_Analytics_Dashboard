{% extends "_layout.html" %}

{% block title %}Ingredient Totals{% endblock %}

{% block content %}


<h1>Aggregated Ingredient Totals</h1>
<p>This page shows the total amount of each ingredient needed for all recipes.</p>

<div class="content-card">
    <div class="search-container">
        <input type="text" id="totalsSearch" placeholder="Search for ingredients by name...">
    </div>
    <h2>Total Raw Materials</h2>
    <table>
        <thead>
            <tr>
                <th>Ingredient</th>
                <th>Total Quantity</th>
                <th>Unit</th>
            </tr>
        </thead>
        <tbody>
            {% for item in totals %}
            <tr>
                <td>{{ item.name }}</td>
                <td>{{ item.total_quantity | round(2) }}</td>
                <td>{{ item.unit }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('totalsSearch');
        const tableBody = document.querySelector('.content-card tbody');
        const allRows = tableBody.querySelectorAll('tr');

        searchInput.addEventListener('input', function (e) {
            const searchTerm = e.target.value.toLowerCase();

            allRows.forEach(row => {
                // Get the text from the 1st cell (Ingredient)
                const itemName = row.cells[0].textContent.toLowerCase();

                if (itemName.includes(searchTerm)) {
                    row.style.display = ''; // Show the row
                } else {
                    row.style.display = 'none'; // Hide the row
                }
            });
        });
    });
</script>
{% endblock %}